<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
    <script src="/script/api" type="text/javascript"></script>
    <title>Kindle设置</title>
</head>

<body>
    <div class="container-fluid">
        <div class="row container-fluid p-0 m-0">
            <div class="col flex-grow-1">
                <form id="setting_form">
                    <div class="card bg-light">
                        <div class="card-body">
                            <button type="button" class="btn btn-success" id="btn_save">保存</button>
                            <button type="reset" class="btn btn-primary" id="btn_default">恢复默认</button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            功能说明
                        </div>
                        <div class="card-body">
                            <blockquote class="blockquote mb-0">
                                <p>通过【发送至Kindle】电子邮件地址将生成的书籍发送至您的Kindle。这个邮件地址可以在Kindle上【设置-您的账户】中查看，也能在
                                    www.amazon.cn/myk 查看/更改相关设置。</p>
                                <p>【发件邮箱】用于发送邮件，需要使用您的邮箱进行发送，所以需要提供邮箱地址及认证码。</p>
                            </blockquote>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            Kindle 设置
                        </div>
                        <div class="card-body">
                            <div class="form-group row">
                                <label class="col-sm-2 col-form-label" for="kindle_email">【发送至Kindle】电子邮件地址</label>
                                <div class="col-sm-10">
                                    <div class="form-row">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="@KINDLE.CN"
                                                id="kindle_email" value=''>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            发件邮箱设置
                        </div>
                        <div class="card-body">
                            <div class="form-group row">
                                <label class="col-sm-2 col-form-label" for="email">发邮件邮箱</label>
                                <div class="col-sm-10">
                                    <div class="form-row">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="用于发送邮件到Kindle邮箱的发件箱"
                                                id="email" value=''>
                                        </div>
                                    </div>
                                </div>
                                <label class="col-sm-2 col-form-label" for="email_pass">认证码</label>
                                <div class="col-sm-10">
                                    <div class="form-row">
                                        <div class="input-group">
                                            <input type="password" class="form-control"
                                                placeholder="注意：如若是QQ邮箱，这里则是独立的收件认证码，不是QQ密码" id="email_pass" value=''>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
        $(() => {

            $("#btn_save").on("click", UpdateSetting);

            GetSetting();
        });
        function GetSetting() {
            $.ajax({
                url: "/api/setting/kindle", method: "GET", dataType: "json",
                success: (result) => {
                    console.log(result);
                    $("#kindle_email").val(result.kindle_email);
                    $("#email").val(result.email);
                    $("#email_pass").val(result.pass);
                }
            });
        }
        //更新
        function UpdateSetting() {
            var setting = {
                kindle_email: $("#kindle_email").val(),
                email: $("#email").val(),
                pass: $("#email_pass").val()
            }
            $.ajax({
                url: "/api/setting/kindle", method: "PUT", dataType: "json", contentType: 'application/json', data: JSON.stringify(setting),
                success: (result) => {
                    //if (callback) callback(result);
                    console.log(result);
                }
            });
        }



    </script>
</body>


</html>